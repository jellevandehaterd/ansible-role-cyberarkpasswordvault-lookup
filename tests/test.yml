#!/usr/bin/env OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES ansible-playbook

---
- hosts: localhost
  connection: local
  vars:
    cyberark_safe: "{{ my_safe_name }}"
    cyberark_connection:
      validate_certs: True
      url: '{{ my_cyberark_url}}'
      username: "{{ my_username }}"
      password: "{{ my_password }}"
      use_radius_authentication: False

  roles:
  - ansible-role-cyberarkpasswordvault-lookup
  tasks:
  - debug:
      msg: "{{lookup('cyberarkpasswordvault', 'test, localhost', passprops=True, errors='warn')}}"

  - debug:
      var: item
    loop: "{{query('cyberarkpasswordvault', keywords, passprops=True, errors='warn')}}"